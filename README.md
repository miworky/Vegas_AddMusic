# Vegas_AddMusic
# ●概要

このプログラムは、Vegas Pro 19.0 のスクリプトです。
このスクリプトを使用すると、動画＆画像が混在しているタイムラインのうち、画像が連続している区間に BGM を追加できます。

# ●背景

みてねから画像や動画をダウンロードして動画を作成したり、ブルーレイに焼いたりする際に、いくつか課題があります。
課題の一つは、BGM を付けるのが面倒だということです。
やりたいことは単に BGM を画像の部分にだけ付けて、動画の部分には付けない、ということです。
たったこれだけのことなのに、手作業でやると画像の数が多いとものすごく時間がかかります。

このスクリプトを使用すれば、この作業を自動化できます。

# ●動画作成手順

1)みてねからファイルをダウンロードする

  https://github.com/miworky/miteneDownloader

を使用してダウンロードしてください。
  ダウンロードしたファイルは、「YYYY-MM-DDThhmmss_みてねの1つめのコメント」というファイル名になります。
  
2)ダウンロードしたファイルを Vegas Pro のメディアプールに取り込み、タイムラインに貼り付けます。

　ダウンロードしたファイル名に日付が含まれているので、これだけでみてねからダウンロードしたファイルを撮影日時順にタイムラインに配置できます。
 　画像・動画は Track 2 に追加してください。

3)撮影日とコメントからテロップを作成します

　https://github.com/miworky/Vegas_AddTextEventFromFilename

を使用すると自動でテロップを追加できます。テロップは Track 1 に作成されます。

4)オリジナルの高解像度のファイルに差し替えます

   https://github.com/miworky/Vegas_ReplaceMediaFiles

を使用すると、自動でオリジナルの高解像度のファイルに差し替えできます。

5)お好きな BGM を貼り付けます（本プログラムを使用します）

  BGM は Track 5 に作成されます。

6)動画として書き出したり、ブルーレイに焼いたりします。

7)テロップの時刻と内容をテキストファイルに書き出します

  https://github.com/miworky/Vegas_ExportTextEvent

　を使用すると自動でテロップの時刻と内容をテキストファイルに書き出せます。
 
 # ●仕様

Track 2 に画像が 2 つ以上連続していれば、 その区間の Track 5 に BGM を追加します。
BGM として追加する音楽ファイルはあらかじめメディアプールに登録しておきます。メディアプールに登録されている順に BGM として使われます。
たとえば、

01.mp3

02.mp3

03.mp3

のような音楽ファイルがメディアプールに登録してあれば、

01.mp3

02.mp3

03.mp3

の順に BGM として使われます。


Vegas Pro のプロジェクトにあらかじめ以下のようなトラックを作ってください：

Track 1: Videoトラック（テロップ）

Track 2: Videoトラック（画像・動画。このトラックに画像があれば Track 5 に BGM を追加します）

Track 3: 音声トラック（画像・動画の音声）

Track 4: 音声トラック（画像・動画の音声）

Track 5: 音声トラック（このトラックに、本スクリプトで BGM を追加します）


 # ●開発環境

VisualStudio 2019 C#


 # ●ビルド方法

1)AddMusic.sln を VisualStudio2019 で開きます

2)Release, Any CPUでビルド

AddMusic\bin\Releaseに成果物ができあがります。


# ●デプロイ方法

C:\ProgramData\VEGAS Pro\Script Menu
に以下のファイルをコピーします：

AddMusic\bin\Release\AddMusic.dll


# ●実行方法

1)あらかじめ Track 2 に画像と動画を張り付けておきます

2)Track 5 に空の音声トラックを追加します

3)Vegas Pro 19.0 から本スクリプトを実行します

　Track 2 に画像が 2 つ以上続いていれば、 Track 5 に BGM が追加されます。
 

